<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>4 Fixed Color Bars with Inputs</title>
  <style>
    :root{
      --bg: #0f172a;
      --text: #e5e7eb;
      --chart-height: clamp(400px, 70vh, 800px);
      --bar-radius: 12px;
      --gap: 16px;
      --bar1: #d71920; /* red */
      --bar2: #0067b8; /* blue */
      --bar3: #e5a300; /* yellow */
      --bar4: #107c10; /* green */
    }
    *{ box-sizing: border-box; }
    html, body{ height: 100%; margin: 0; font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; color: var(--text); background: var(--bg); }
    .page{ max-width: 900px; margin: 0 auto; padding: 24px; display: grid; gap: 18px; }
    header h1{ margin: 0; font-size: clamp(18px, 3vw, 28px); }

    /* Controls */
    .controls{ background: rgba(255,255,255,0.04); border: 1px solid rgba(255,255,255,0.12); border-radius: 14px; padding: 14px; display: grid; gap: 10px; }
    .inputs{ display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; }
    .inputs input{ width: 100%; padding: 10px 12px; border-radius: 10px; border: 1px solid rgba(255,255,255,0.18); background: #111827; color: var(--text); }
    .inputs input:focus{ outline: none; border-color: rgba(255,255,255,0.35); box-shadow: 0 0 0 5px rgba(255,255,255,0.08); }
    .list-input input{ width: 100%; padding: 10px 12px; border-radius: 10px; border: 1px solid rgba(255,255,255,0.18); background: #111827; color: var(--text); margin-top: 10px; }

    .tests{ display: flex; flex-wrap: wrap; gap: 8px; }
    .test-btn{ background: rgba(255,255,255,0.08); border: 1px solid rgba(255,255,255,0.18); color: var(--text); padding: 8px 10px; border-radius: 10px; cursor: pointer; font-size: 12px; }

    /* Chart */
    .chart-wrap{ height: var(--chart-height); }
    .bar-stage{ display: flex; align-items: stretch; gap: var(--gap); height: 100%; }
    .bar-col{ flex: 1 1 0; display: grid; grid-template-rows: 1fr auto; gap: 10px; text-align: center; height: 100%; min-width: 0; }
    .bar{ width: 100%; height: 0%; border-radius: var(--bar-radius); transition: height .6s cubic-bezier(.2,.7,.1,1); align-self: end; box-shadow: inset 0 1px 0 rgba(255,255,255,0.22), 0 12px 24px rgba(0,0,0,0.28); }
    .label{ margin-top: 4px; font-weight: 800; font-size: clamp(22px, 4vw, 44px); color: var(--text); user-select: none; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }

    @media (max-width: 680px){ .inputs{ grid-template-columns: repeat(2, 1fr); } }
  </style>
</head>
<body>
  <main class="page">
    <header>
      <h1>4 Barras de Colores Fijos</h1>
    </header>

    <!-- Controls -->
    <section class="controls" aria-label="Controls">
      <div class="inputs">
        <input id="val1" type="number" inputmode="decimal" value="10" min="0" aria-label="Number 1 (red)" />
        <input id="val2" type="number" inputmode="decimal" value="20" min="0" aria-label="Number 2 (blue)" />
        <input id="val3" type="number" inputmode="decimal" value="30" min="0" aria-label="Number 3 (yellow)" />
        <input id="val4" type="number" inputmode="decimal" value="40" min="0" aria-label="Number 4 (green)" />
      </div>
      <div class="list-input">
        <input id="valList" type="text" placeholder="Enter 4 numbers separated by commas" aria-label="Numbers list" />
      </div>
      <!-- Quick tests (basic test cases) -->
      <div class="tests">
        <button class="test-btn" data-values="10,20,30,40">Test: 10,20,30,40</button>
        <button class="test-btn" data-values="0,50,100,150">Test: 0,50,100,150</button>
        <button class="test-btn" data-values="5,15,25,100">Test: 5,15,25,100</button>
        <button class="test-btn" data-values="0,0,0,0">Test: all zeros</button>
      </div>
      <div id="err" style="display:none;color:#f87171"></div>
    </section>

    <!-- Chart -->
    <section class="chart-wrap" aria-label="Chart">
      <div id="stage" class="bar-stage"></div>
    </section>
  </main>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const css = getComputedStyle(document.documentElement);
      const colors = [css.getPropertyValue('--bar1').trim(), css.getPropertyValue('--bar2').trim(), css.getPropertyValue('--bar3').trim(), css.getPropertyValue('--bar4').trim()];

      function buildBars(values){
        const stage = document.getElementById('stage');
        let cols = stage.querySelectorAll('.bar-col');
        if(cols.length !== 4){
          stage.innerHTML = '';
          for(let i=0;i<4;i++){
            const col = document.createElement('div');
            col.className = 'bar-col';
            const bar = document.createElement('div');
            bar.className = 'bar';
            bar.style.background = colors[i];
            bar.style.height = '0%';
            const label = document.createElement('div');
            label.className = 'label';
            label.textContent = '0';
            col.appendChild(bar);
            col.appendChild(label);
            stage.appendChild(col);
          }
          cols = stage.querySelectorAll('.bar-col');
        }
        const max = Math.max(0, ...values);
        const safeMax = max > 0 ? max : 1;
        values.forEach((v, i) => {
          const col = cols[i];
          const bar = col.querySelector('.bar');
          const label = col.querySelector('.label');
          label.textContent = v;
          bar.style.height = (v / safeMax * 100) + '%';
        });
      }

      function currentValues(){
        const ids = ['val1','val2','val3','val4'];
        return ids.map(id => {
          const n = Number(document.getElementById(id).value);
          return Number.isFinite(n) && n >= 0 ? n : 0;
        });
      }

      function updateFromInputs(){
        const vals = currentValues();
        buildBars(vals);
      }

      function updateFromList(){
        const listVal = document.getElementById('valList').value.trim();
        if(!listVal) return;
        const parts = listVal.split(',').map(s => Number(s.trim()));
        if(parts.length === 4 && parts.every(n => Number.isFinite(n) && n >= 0)){
          ['val1','val2','val3','val4'].forEach((id, i) => {
            document.getElementById(id).value = parts[i];
          });
          buildBars(parts);
        }
      }

      document.querySelectorAll('.inputs input').forEach(inp => {
        inp.addEventListener('input', updateFromInputs);
        inp.addEventListener('keydown', (e)=>{ if(e.key === 'Enter'){ e.preventDefault(); updateFromInputs(); } });
      });

      document.getElementById('valList').addEventListener('input', updateFromList);

      document.querySelectorAll('.test-btn').forEach(btn => {
        btn.addEventListener('click', () => {
          const vals = (btn.getAttribute('data-values')||'').split(',').map(s=>s.trim());
          ['val1','val2','val3','val4'].forEach((id, i)=>{ document.getElementById(id).value = vals[i] ?? 0; });
          updateFromInputs();
        });
      });

      updateFromInputs();
    });
  </script>
</body>
</html>
